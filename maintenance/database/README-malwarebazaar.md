# MalwareBazaar

MalwareBazaar is a project run by abuse.ch, a research project at the Bern
University of Applied Sciences. It offers a dataset with information about
known malware under a CC0 license at: <https://bazaar.abuse.ch/export/>. This
dataset only contains information about known malware.

Some interesting information in this data:

* SHA256 checksum
* TLSH checksum
* import hash (imphash), relevant for PE files
* name/signature of the malware (if any)

## Requirements

* PostgreSQL version that supports UPSERT and hash indexes (10 or higher)
* Python 3
* psycopg2 2.7.x

## Loading the data

For this script either the full CSV or the CSV with "recent additions" can be
used.

To import the data do the following:

1. add the right tables to the database:

    $ psql -U username < malwarebazaar-init.sql

2. run the script to load the passwords into the database

    $ python3 malwarebazaarimporter.py -c /path/to/configuration/file -f /path/to/csv

## Statistics

Some statistics about a recent version (August 25, 2021) of the CSV:

    bang=> \dt+

                       List of relations
     Schema |  Name   | Type  | Owner | Size  | Description
    --------+---------+-------+-------+-------+-------------
     public | malware | table | bang  | 95 MB |
    (1 row)

    bang=> \di+;
                                 List of relations
     Schema |       Name       | Type  | Owner |  Table  | Size  | Description
    --------+------------------+-------+-------+---------+-------+-------------
     public | malware_filename | index | bang  | malware | 12 MB |
     public | malware_imphash  | index | bang  | malware | 16 MB |
     public | malware_pkey     | index | bang  | malware | 46 MB |
    (3 rows)


    bang=> select from malware ;
    --
    (380501 rows)


# Database design

There is one table, with the following schema:

    CREATE TABLE IF NOT EXISTS malware(sha256 text, tlsh text, imphash text, filename text, signature text, mimetype text, PRIMARY KEY(sha256));

There are two additional indexes:

    CREATE INDEX malware_filename ON malware(filename);
    CREATE INDEX malware_imphash ON malware(imphash);
